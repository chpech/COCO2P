  
  [1X1 [33X[0;0YColor Graphs[133X[101X
  
  
  [1X1.1 [33X[0;0YTheory[133X[101X
  
  [33X[0;0YA  color  graph  (cgr)  in  [5XCOCO2P[105X  is a triple [22X(V,C,f)[122X, where [22XV[122X is a set of
  vertices,  [22XC[122X  is  set of colors, and [22Xf : V Ã— V -> C[122X assigns to every arc its
  color. [5XCOCO2P[105X does not know the concept of non-arcs. However, this is not an
  essential  restriction,  since  non-arcs  may  be simulated by introducing a
  special distinguished color.[133X
  
  [33X[0;0YOf special interrest in [5XCOCO2P[105X are WL-stable color graphs (that is cgrs that
  are  stable  under  the  Weisfeiler-Leman algorithm [WL68], [Wei76]). In the
  frames of [5XCOCO2P[105X the maximal monochromatic sets of arcs of a WL-stable color
  graph  will  always  form  a [13Xcoherent configuration[113X. On the other hand, from
  every  coherent  configuration  we can obtain a WL-stable cgr (every pair of
  vertices is colored by the relation it belongs to).[133X
  
  [33X[0;0YFor  historical  reasons,  [5XCOCO2P[105X  uses  the  nomenclature  of color graphs.
  However,  this  is  only  of  importance for concepts like automorphisms and
  isomorphisms.  While  both,  automorphisms and isomorphisms have to preserve
  colors  (as  it  is  expected  for  color  graphs), color-automorphisms, and
  color-isomorphisms only have to respect color classes, that is, they may map
  arcs of one color to arcs of another color.[133X
  
  
  [1X1.2 [33X[0;0YOn the representation of color graphs in [5XCOCO2P[105X[101X[1X[133X[101X
  
  [33X[0;0YFor  a  color graph, the set of vertices as well as the set of colors may be
  any  finite  set  representable in [5XGAP[105X. For performance reasons, [5XCOCO2P[105X does
  not  use  these  sets  inside its algorithms (except when constructing color
  graphs).  Instead, [5XCOCO2P[105X refers to vertices and colors by their position in
  the  vertex-set and color-set, respectively. In fact vertices and colors are
  identified  with  these  indices.  In  order not to loose information, every
  color  graph in [5XCOCO2P[105X keeps a list of names of vertices and a list of names
  of colors. The set of vertex-names is equal to the original set of vertices,
  and the set of color names is equal to the original set of colors.[133X
  
  
  [1X1.3 [33X[0;0YFunctions for the construction of color graphs[133X[101X
  
  [1X1.3-1 ColorGraphByOrbitals[101X
  
  [33X[1;0Y[29X[2XColorGraphByOrbitals[102X( [3Xgrp[103X[, [3Xdomain[103X[, [3XAction[103X[, [3XcompleteDom[103X]]] ) [32X function[133X
  
  [33X[0;0YThis  function  constructs  the  color graph of orbitals color graphs from a
  group  action  by mapping each arc to a representative of its orbital of the
  given group action.[133X
  
  [33X[0;0YIn  its  first form, the function returns the color graph of orbitals of the
  permutation  group [3Xgrp[103X in its natural action (i.e. on [22X{1,dots,n}[122X, where [22Xn[122X is
  the largest moved point of [3Xgrp[103X).[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xd7 := Group( (1,2,3,4,5,6,7), (1,7)(2,6)(3,5));;[127X[104X
    [4X[25Xgap>[125X [27Xcgr := ColorGraphByOrbitals(d7);[127X[104X
    [4X[28X<color graph of order 7 and rank 4>[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [33X[0;0YIn  the  second form the function returns the color graph of orbitals of [3Xgrp[103X
  acting  on  [3Xdomain[103X  [10XOnPoints[110X. If [3Xdomain[103X is not invariant under [3Xgrp[103X, then the
  smallest invariant extension of [3Xdomain[103X is taken as acting domain.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xd7 := Group( (1,2,3,4,5,6,7), (1,7)(2,6)(3,5));;[127X[104X
    [4X[25Xgap>[125X [27Xcgr := ColorGraph(d7, [1]);[127X[104X
    [4X[28X<color graph of order 7 and rank 4>[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [33X[0;0YIn the third variant of [10XColorGraphByOrbitals[110X an action can be given:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(SymmetricGroup(5), Combinations([1..5],2), OnSets);[127X[104X
    [4X[28X<color graph of order 10 and rank 3>[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  optional  fourth argument [3XcompleteDom[103X is a boolean. If it is [9XTrue[109X, then
  the function assumes that [3Xdomain[103X is closed under [3Xaction[103X of [3Xgrp[103X. This has the
  effect, that the function dows not try to complete it. The effect is that in
  the  resulting  color  graph  it is guaranteed that the vertex with number [10Xi[110X
  corresponds exactly to [10Xdomain[i][110X.[133X
  
  [1X1.3-2 ColorGraph[101X
  
  [33X[1;0Y[29X[2XColorGraph[102X( [3Xgrp[103X[, [3Xdomain[103X[, [3Xaction[103X[, [3XcompleteDom[103X[, [3Xcoloring[103X]]]] ) [32X function[133X
  
  [33X[0;0YThis is the most general function for the construction of color graphs. When
  called  with  less  than  [22X5[122X  arguments,  it  is  identical with the function
  [2XColorGraphByOrbitals[102X ([14X1.3-1[114X)[133X
  
  [33X[0;0YThe  optional  fifth  argument  [3Xcoloring[103X is a coloring-function. It takes as
  input  two  vertices  (elements  of  the  acting domain) [22Xu, v[122X, and it has to
  return  the  color of the arc [22X(u, v)[122X. In principle, the color can be any [5XGAP[105X
  object. However, it should be possible to compare colors and to form sets of
  them.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(SymmetricGroup(8),[127X[104X
    [4X[25X>[125X [27XCombinations([1..8],4), OnSets, true,[127X[104X
    [4X[25X>[125X [27Xfunction(u,v) return[127X[104X
    [4X[25X>[125X [27XLength(Intersection(u,v));end);[127X[104X
    [4X[28X<color graph of order 70 and rank 5>[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [33X[0;0YIt  is  supposed  that [3Xcoloring[103X is invariant under the given action (this is
  not checked!).[133X
  
  [1X1.3-3 ColorGraphByMatrix[101X
  
  [33X[1;0Y[29X[2XColorGraphByMatrix[102X( [3Xmat[103X ) [32X function[133X
  
  [33X[0;0YThis  function  constructs  a  color  graph  from  its adjacency matrix. The
  argument  [3Xmat[103X  is  a  list  of  [22Xn[122X  lists  of length [22Xn[122X. The vertex-set of the
  resulting  color  graph  is  [22X{1,dots,n}[122X, while the color of the arc [22X(i,j)[122X is
  [10Xmat[i][j][110X.  The  entries can be any kind of [5XGAP[105X-objects that can be compared
  and that can be organized in a set.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xm:=[["black","red"  ,"blue" ,"blue" ,"blue" ],[127X[104X
    [4X[25X>[125X [27X       ["blue" ,"black","red"  ,"blue" ,"blue" ],[127X[104X
    [4X[25X>[125X [27X       ["blue" ,"blue", "black","red"  ,"blue" ],[127X[104X
    [4X[25X>[125X [27X       ["blue" ,"blue", "blue" ,"black","red"  ],[127X[104X
    [4X[25X>[125X [27X       ["red"  ,"blue", "blue" ,"blue" ,"black"]];;[127X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraphByMatrix(m);[127X[104X
    [4X[28X<color graph of order 5 and rank 3>[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.3-4 ColorGraphByWLStabilization[101X
  
  [33X[1;0Y[29X[2XColorGraphByWLStabilization[102X( [3Xcgr[103X ) [32X function[133X
  
  [33X[0;0YIf   [3Xcgr[103X  is  WL-stable  then  the  function  returns  [3Xcgr[103X.  Otherwise,  the
  WL-stabilization  of  [3Xcgr[103X  is returned. The colors of the stabilization have
  names  of  the shape [10X[c,i][110X where [10Xc[110X is a color of [3Xcgr[103X and [10Xi[110X is the index of a
  fragment of color [10Xc[110X.[133X
  
  [33X[0;0YThis  function  does  not  really  implement the Weisfeiler-Leman algorithm.
  Rather  it  does  a  stabilization inside of a Schurian WL-stable fission of
  [3Xcgr[103X.  The  performance  depends  mainly  on  the order of the group of known
  automorphisms of [3Xcgr[103X (cf [2XKnownGroupOfAutomorphisms[102X ([14X1.7-1[114X)).[133X
  
  [1X1.3-5 WLStableColorGraphByMatrix[101X
  
  [33X[1;0Y[29X[2XWLStableColorGraphByMatrix[102X( [3Xmat[103X ) [32X function[133X
  
  [33X[0;0YThis  function gets as input a square matrix [3Xmat[103X and returns the color graph
  of the Weisfeiler-Leman- stabilization of [3XMat[103X. The entries of [3Xmat[103X can be any
  kind of [5XGAP[105X-objects that can be compared and that can be organized in a set.
  The  vertex-set  of the resulting color graph is [22X{1,dots,n}[122X, while the color
  of the arc [22X(i,j)[122X is [10X[mat[i][j],k][110X, where [10Xk[110X is a positive integer.[133X
  
  [33X[0;0YThis   constructor  works  usually  much  faster  then  the  combination  of
  [2XColorGraphByMatrix[102X ([14X1.3-3[114X) and [2XColorGraphByWLStabilization[102X ([14X1.3-4[114X).[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xc:=AllAssociationSchemes(10)[3];[127X[104X
    [4X[28XAS(10,3)[128X[104X
    [4X[25Xgap>[125X [27Xa:=AdjacencyMatrix(c);;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(a);[127X[104X
    [4X[28X[ [  1,  2,  2,  2,  3,  3,  3,  3,  3,  3 ],[128X[104X
    [4X[28X  [  2,  1,  3,  3,  2,  2,  3,  3,  3,  3 ],[128X[104X
    [4X[28X  [  2,  3,  1,  3,  3,  3,  2,  2,  3,  3 ],[128X[104X
    [4X[28X  [  2,  3,  3,  1,  3,  3,  3,  3,  2,  2 ],[128X[104X
    [4X[28X  [  3,  2,  3,  3,  1,  3,  2,  3,  2,  3 ],[128X[104X
    [4X[28X  [  3,  2,  3,  3,  3,  1,  3,  2,  3,  2 ],[128X[104X
    [4X[28X  [  3,  3,  2,  3,  2,  3,  1,  3,  3,  2 ],[128X[104X
    [4X[28X  [  3,  3,  2,  3,  3,  2,  3,  1,  2,  3 ],[128X[104X
    [4X[28X  [  3,  3,  3,  2,  2,  3,  3,  2,  1,  3 ],[128X[104X
    [4X[28X  [  3,  3,  3,  2,  3,  2,  2,  3,  3,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27Xa[1][1]:=4;;[127X[104X
    [4X[25Xgap>[125X [27Xc1:=ColorGraphByMatrix(a);[127X[104X
    [4X[28X<color graph of order 10 and rank 4>[128X[104X
    [4X[25Xgap>[125X [27Xc2:=WLStableColorGraphByMatrix(a);[127X[104X
    [4X[28X<color graph of order 10 and rank 15>[128X[104X
    [4X[25Xgap>[125X [27XDisplay(c1);[127X[104X
    [4X[28X[ [  4,  2,  2,  2,  3,  3,  3,  3,  3,  3 ],[128X[104X
    [4X[28X  [  2,  1,  3,  3,  2,  2,  3,  3,  3,  3 ],[128X[104X
    [4X[28X  [  2,  3,  1,  3,  3,  3,  2,  2,  3,  3 ],[128X[104X
    [4X[28X  [  2,  3,  3,  1,  3,  3,  3,  3,  2,  2 ],[128X[104X
    [4X[28X  [  3,  2,  3,  3,  1,  3,  2,  3,  2,  3 ],[128X[104X
    [4X[28X  [  3,  2,  3,  3,  3,  1,  3,  2,  3,  2 ],[128X[104X
    [4X[28X  [  3,  3,  2,  3,  2,  3,  1,  3,  3,  2 ],[128X[104X
    [4X[28X  [  3,  3,  2,  3,  3,  2,  3,  1,  2,  3 ],[128X[104X
    [4X[28X  [  3,  3,  3,  2,  2,  3,  3,  2,  1,  3 ],[128X[104X
    [4X[28X  [  3,  3,  3,  2,  3,  2,  2,  3,  3,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27XDisplay(c2);[127X[104X
    [4X[28X[[[4,1],[2,1],[2,1],[2,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1]],[128X[104X
    [4X[28X [[2,2],[1,2],[3,4],[3,4],[2,5],[2,5],[3,6],[3,6],[3,6],[3,6]],[128X[104X
    [4X[28X [[2,2],[3,4],[1,2],[3,4],[3,6],[3,6],[2,5],[2,5],[3,6],[3,6]],[128X[104X
    [4X[28X [[2,2],[3,4],[3,4],[1,2],[3,6],[3,6],[3,6],[3,6],[2,5],[2,5]],[128X[104X
    [4X[28X [[3,2],[2,4],[3,5],[3,5],[1,1],[3,3],[2,3],[3,7],[2,3],[3,7]],[128X[104X
    [4X[28X [[3,2],[2,4],[3,5],[3,5],[3,3],[1,1],[3,7],[2,3],[3,7],[2,3]],[128X[104X
    [4X[28X [[3,2],[3,5],[2,4],[3,5],[2,3],[3,7],[1,1],[3,3],[3,7],[2,3]],[128X[104X
    [4X[28X [[3,2],[3,5],[2,4],[3,5],[3,7],[2,3],[3,3],[1,1],[2,3],[3,7]],[128X[104X
    [4X[28X [[3,2],[3,5],[3,5],[2,4],[2,3],[3,7],[3,7],[2,3],[1,1],[3,3]],[128X[104X
    [4X[28X [[3,2],[3,5],[3,5],[2,4],[3,7],[2,3],[2,3],[3,7],[3,3],[1,1]]][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.3-6 ClassicalCompleteAffineScheme[101X
  
  [33X[1;0Y[29X[2XClassicalCompleteAffineScheme[102X( [3Xq[103X ) [32X function[133X
  
  [33X[0;0YThe  classical  complete  affine  scheme  is a WL-stable, Schurian, amorphic
  color graph defined on the set of points of the affine plane over [22XGF(q)[122X. The
  reflexive  closure  of  every  irreflexive  color  class  is  an equivalence
  relation  whose equivalence classes form a complete parallel class of lines.
  Moreover, to every parallel class there corresponds a color class.[133X
  
  [33X[0;0YThis function returns the classical complete affine scheme over [22XGF(q)[122X.[133X
  
  [1X1.3-7 JohnsonScheme[101X
  
  [33X[1;0Y[29X[2XJohnsonScheme[102X( [3Xn[103X, [3Xk[103X ) [32X function[133X
  
  [33X[0;0YThe Johnson scheme [22XJ(n,k)[122X is a WL-stable, Schurian color graph. Its vertices
  are  the  [3Xk[103X-element  subsets  of  [22X{1,dots,n}[122X.  The  colors  are  elements of
  [22X{0,dots,k}[122X. The color of an arc [22X(M,N)[122X is the cardinality of the intersection
  of [22XM[122X and [22XN[122X.[133X
  
  [33X[0;0YThis function returns the Johnson scheme [22XJ(n,k)[122X.[133X
  
  [1X1.3-8 CyclotomicColorGraph[101X
  
  [33X[1;0Y[29X[2XCyclotomicColorGraph[102X( [3Xp[103X, [3Xn[103X, [3Xd[103X ) [32X function[133X
  
  [33X[0;0YLet  [22Xp[122X  be  a prime, [22Xn[122X, [22Xd[122X be positive integers, such that [22Xd[122X divides [22X(p^n-1)[122X.
  Let  [22Xq:=p^n[122X,  and let [22Xr[122X be a primitive element of [22XGF(q)[122X. Let [22XC[122X be the set of
  all  powers  of  [22Xr^d[122X in [22XGF(q)[122X the cyclotomic colored graph [22XCyc(p,n,d)[122X has as
  vertices   the   elements   of   [22XGF(q)[122X.  The  set  of  colors  is  given  by
  [22X{*,0,1,...,d-1}[122X.  A pair [22X(x,y)[122X of vertices has color [22X*[122X in [22XCyc(p,n,d)[122X if [22Xx=y[122X.
  It has color [22Xi[122X if [22X(x-y)[122X is an element of [22XCâ‹…(r^i)[122X.[133X
  
  [33X[0;0YThis function returns the Cyclotomic scheme [22XCyc(p,n,d)[122X.[133X
  
  [1X1.3-9 BIKColorGraph[101X
  
  [33X[1;0Y[29X[2XBIKColorGraph[102X( [3Xm[103X ) [32X function[133X
  
  [33X[0;0YThis  function  generates  the  color graphs described in the paper [BIK89].
  These  color  graphs  are  interesting because they may be used to construct
  [22X3[122X-isoregular strongly regular graphs with the [22X5[122X-vertex condition. The vertex
  set  of [10XBIKColorGraph(m)[110X is [22XV=GF(2)^2m[122X. For the description of colors of the
  arcs  consider a quadratic form [22Xq[122X of Witt-index [22Xm[122X on [22XV[122X. Let [22XQ[122X be the quadric
  defined  by  [22Xq[122X,  and  let  [22XS[122X  be a maximal singular subspace of [22Xq[122X. A pair of
  vectors [22X(v,w)[122X is colored by[133X
  
  [8X[10X"=":[110X[8X[108X
        [33X[0;6Yif [22Xv = w[122X,[133X
  
  [8X[10X"Q+S+":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆˆ S[122X,[133X
  
  [8X[10X"Q+S-":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆˆ Q âˆ– S[122X,[133X
  
  [8X[10X"Q-":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆ‰ Q[122X.[133X
  
  [33X[0;0YThe  following  code  constructs  the Ivanov-graph on [22X256[122X vertices. This was
  historically the first strongly regular graph to be found that is non-rank-[22X3[122X
  and that satisfies the [22X5[122X-vertex condition (cf. [Iva89]).[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=BIKColorGraph(4);[127X[104X
    [4X[28X<color graph of order 256 and rank 4>[128X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr);[127X[104X
    [4X[28X[ "=", "Q+S+", "Q+S-", "Q-" ][128X[104X
    [4X[25Xgap>[125X [27Xgamma:=BaseGraphOfColorGraph(cgr,3);;[127X[104X
    [4X[25Xgap>[125X [27XIsStronglyRegular(gamma);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xgamma.srg;[127X[104X
    [4X[28Xrec( k := 120, lambda := 56, mu := 56, r := 8, s := -8, v := 256 )[128X[104X
    [4X[28X        [128X[104X
  [4X[32X[104X
  
  [1X1.3-10 IvanovColorGraph[101X
  
  [33X[1;0Y[29X[2XIvanovColorGraph[102X( [3Xm[103X ) [32X function[133X
  
  [33X[0;0YThis function generates a series of color graphs described in [Iva94]. These
  color  graphs  may be used to construct [22X3[122X-isoregular strongly regular graphs
  with the [22X5[122X-vertex condition. These color graphs are interesting because they
  may  be  used  to  construct  [22X3[122X-isoregular  strongly regular graphs with the
  [22X5[122X-vertex condition. The vertex set of [10XIvanovColorGraph(m)[110X is [22XV=GF(2)^2m[122X. For
  the  description  of  colors  of  the  arcs  consider  a quadratic form [22Xq[122X of
  Witt-index  [22Xm-1[122X  on [22XV[122X. Let [22XQ[122X be the quadric defined by [22Xq[122X, let [22XS[122X be a maximal
  singular  subspace of [22Xq[122X, and let [22XO[122X be the orthogonal complement of [22XS[122X. A pair
  of vectors [22X(v,w)[122X is colored by[133X
  
  [8X[10X"=":[110X[8X[108X
        [33X[0;6Yif [22Xv = w[122X,[133X
  
  [8X[10X"Q+S+":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆˆ S[122X,[133X
  
  [8X[10X"Q+S-":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆˆ Q âˆ– S[122X,[133X
  
  [8X[10X"Q-O+":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆˆ O[122X.[133X
  
  [8X[10X"Q-O-":[110X[8X[108X
        [33X[0;6Yif [22Xv + w âˆ‰ O âˆª Q[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=IvanovColorGraph(5);[127X[104X
    [4X[28X<color graph of order 1024 and rank 5>[128X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr);[127X[104X
    [4X[28X[ "=", "Q+S+", "Q+S-", "Q-O+", "Q-O-" ][128X[104X
    [4X[25Xgap>[125X [27Xgamma:=BaseGraphOfColorGraph(cgr,[2,5]);;[127X[104X
    [4X[25Xgap>[125X [27XIsStronglyRegular(gamma);;[127X[104X
    [4X[25Xgap>[125X [27Xgamma.srg;[127X[104X
    [4X[28Xrec( k := 495, lambda := 238, mu := 240, r := 15, s := -17, v := 1024 )[128X[104X
    [4X[28X          [128X[104X
  [4X[32X[104X
  
  [1X1.3-11 AllAssociationSchemes[101X
  
  [33X[1;0Y[29X[2XAllAssociationSchemes[102X( [3Xn[103X ) [32X function[133X
  
  [33X[0;0YThis  function  creates  an  interface  to the database of small association
  schemes     by     Akihide     Hanaki     and     Izumi     Miyamoto    from
  [7Xhttp://math.shinshu-u.ac.jp/~hanaki/as/[107X  (further refered to as the Japanese
  catalogue)[133X
  
  [33X[0;0YThis  function  downloads  the list of small association schemes of order [3Xn[103X.
  Then  it  converts  them  to  the  internal format of [5XCOCO2P[105X and returns the
  resulting list. Every color graph has a name of the shape [10XAS(n,k)[110X where [10Xk[110X is
  the  index  of  the scheme in the list of schemes of order [3Xn[103X in the Japanese
  catalogue.[133X
  
  [1X1.3-12 AllCoherentConfigurations[101X
  
  [33X[1;0Y[29X[2XAllCoherentConfigurations[102X( [3Xn[103X ) [32X function[133X
  
  [33X[0;0YThis  function  creates  an  interface  to  the  database  of small coherent
  configurations  on  at  most  15  vertices  by  Matan  Ziv-Av  This function
  downloads  the  list  of  small  coherent configurations of order [3Xn[103X. Then it
  converts  them  to  the  internal format of [5XCOCO2P[105X and returns the resulting
  list. Every color graph has a name of the shape [10XCC(n,k)[110X where [10Xk[110X is the index
  of the scheme in the list of schemes of order [3Xn[103X in Matan's catalogue.[133X
  
  
  [1X1.4 [33X[0;0YFunctions for the inspection of color graphs[133X[101X
  
  [1X1.4-1 OrderOfColorGraph[101X
  
  [33X[1;0Y[29X[2XOrderOfColorGraph[102X( [3Xcgr[103X ) [32X attribute[133X
  [33X[1;0Y[29X[2XOrderOfCocoObject[102X( [3Xcgr[103X ) [32X attribute[133X
  [33X[1;0Y[29X[2XOrder[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YReturns the number of vertices of [3Xcgr[103X.[133X
  
  [1X1.4-2 RankOfColorGraph[101X
  
  [33X[1;0Y[29X[2XRankOfColorGraph[102X( [3Xcgr[103X ) [32X attribute[133X
  [33X[1;0Y[29X[2XRank[102X( [3Xcgr[103X ) [32X method[133X
  
  [33X[0;0YReturns the number of colors of [3Xcgr[103X.[133X
  
  [1X1.4-3 VertexNamesOfCocoObject[101X
  
  [33X[1;0Y[29X[2XVertexNamesOfCocoObject[102X( [3Xcgr[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XVertexNamesOfColorGraph[102X( [3Xcgr[103X ) [32X operation[133X
  
  [33X[0;0YReturns  the  list  of names of the vertices of [3Xcgr[103X. Unfortunately, the more
  elegant  name  [10XVertexNames[110X is used in [5XGrape[105X as the name of a global function
  and can not be overloaded.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=JohnsonScheme(5,2);;[127X[104X
    [4X[25Xgap>[125X [27XVertexNamesOfCocoObject(cgr);[127X[104X
    [4X[28X[ [ 1, 2 ], [ 1, 3 ], [ 1, 4 ], [ 1, 5 ], [ 2, 3 ], [ 2, 4 ], [ 2, 5 ],[128X[104X
    [4X[28X[ 3, 4 ], [ 3, 5 ], [ 4, 5 ] ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-4 ColorNames[101X
  
  [33X[1;0Y[29X[2XColorNames[102X( [3Xcgr[103X ) [32X operation[133X
  
  [33X[0;0YReturns  the  list  of names of the colors of [3Xcgr[103X. In the following example,
  the  color names of the Johnson scheme are the possible cardinalities of the
  intersection  of  two  [22X2[122X-element subsets of [22X{1,2,3,4,5}[122X. Thus loobs will get
  colored  by  [22X1[122X,  since  the intersection of a [22X2[122X-element set with itself will
  have cardinality [22X2[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=JohnsonScheme(5,2);;[127X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr);[127X[104X
    [4X[28X[ 2, 1, 0 ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-5 ArcColorOfColorGraph[101X
  
  [33X[1;0Y[29X[2XArcColorOfColorGraph[102X( [3Xcgr[103X, [3Xu[103X, [3Xv[103X ) [32X method[133X
  [33X[1;0Y[29X[2XArcColorOfColorGraph[102X( [3Xcgr[103X, [3Xarc[103X ) [32X method[133X
  
  [33X[0;0YReturns  the  color  of the arc [22X(u,v)[122X. In the second form, the arc is [3Xarc[103X is
  given as an ordered pair [10X[u,v][110X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=JohnsonScheme(5,2);;[127X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr);[127X[104X
    [4X[28X[ 2, 1, 0 ][128X[104X
    [4X[25Xgap>[125X [27XVertexNamesOfCocoObject(cgr);[127X[104X
    [4X[28X[ [ 1, 2 ], [ 1, 3 ], [ 1, 4 ], [ 1, 5 ], [ 2, 3 ], [ 2, 4 ], [ 2, 5 ],[128X[104X
    [4X[28X[ 3, 4 ], [ 3, 5 ], [ 4, 5 ] ][128X[104X
    [4X[25Xgap>[125X [27XArcColorOfColorGraph(cgr,1,10);[127X[104X
    [4X[28X3[128X[104X
    [4X[25Xgap>[125X [27XArcColorOfColorGraph(cgr,[2,9]);[127X[104X
    [4X[28X2[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-6 ColorRepresentative[101X
  
  [33X[1;0Y[29X[2XColorRepresentative[102X( [3Xcgr[103X, [3Xi[103X ) [32X operation[133X
  
  [33X[0;0YReturns any arc of color [3Xi[103X of [3Xcgr[103X.[133X
  
  [1X1.4-7 Neighbors[101X
  
  [33X[1;0Y[29X[2XNeighbors[102X( [3Xcgr[103X, [3Xvertices[103X, [3Xcolors[103X ) [32X method[133X
  [33X[1;0Y[29X[2XNeighbors[102X( [3Xcgr[103X, [3Xv[103X, [3Xcolors[103X ) [32X method[133X
  [33X[1;0Y[29X[2XNeighbors[102X( [3Xcgr[103X, [3Xvertices[103X, [3Xcolor[103X ) [32X method[133X
  [33X[1;0Y[29X[2XNeighbors[102X( [3Xcgr[103X, [3Xv[103X, [3Xcolor[103X ) [32X method[133X
  
  [33X[0;0YThe  first  variant  returns  the set of all vertices [22Xw[122X of [3Xcgr[103X such that the
  color  of  the  arc  [22X(v,w)[122X  is  an  element  of the set [3Xcolors[103X, for all [22Xv[122X in
  [3Xvertices[103X.[133X
  
  [33X[0;0YThe  second  variant gets as the second argument a single vertex of [3Xcgr[103X, the
  third  gets a single color and the fourth variant gets both, a single vertex
  and a single color..[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=JohnsonScheme(5,2);;[127X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr);[127X[104X
    [4X[28X[ 2, 1, 0 ][128X[104X
    [4X[25Xgap>[125X [27XVertexNamesOfCocoObject(cgr);[127X[104X
    [4X[28X[ [ 1, 2 ], [ 1, 3 ], [ 1, 4 ], [ 1, 5 ], [ 2, 3 ], [ 2, 4 ], [ 2, 5 ],[128X[104X
    [4X[28X[ 3, 4 ], [ 3, 5 ], [ 4, 5 ] ][128X[104X
    [4X[25Xgap>[125X [27XNeighbors(cgr,1,3);[127X[104X
    [4X[28X[ 8, 9, 10 ][128X[104X
    [4X[25Xgap>[125X [27XNeighbors(cgr,1,[1,2]);[127X[104X
    [4X[28X[ 1, 2, 3, 4, 5, 6, 7 ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-8 AdjacencyMatrix[101X
  
  [33X[1;0Y[29X[2XAdjacencyMatrix[102X( [3Xcgr[103X ) [32X method[133X
  [33X[1;0Y[29X[2XAdjacencyMatrix[102X( [3Xcgr[103X, [3Xcolors[103X ) [32X method[133X
  
  [33X[0;0YReturns  the  adjacency  matrix of [3Xcgr[103X. If [22XA[122X is the adjacency matrix of [3Xcgr[103X,
  then [22XA(i,j)[122X is equal to the color (not to the color name!) of the arc [22X(i,j)[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xm:=[["black","red"  ,"blue" ,"blue" ,"blue" ],[127X[104X
    [4X[25X>[125X [27X       ["blue" ,"black","red"  ,"blue" ,"blue" ],[127X[104X
    [4X[25X>[125X [27X       ["blue" ,"blue", "black","red"  ,"blue" ],[127X[104X
    [4X[25X>[125X [27X       ["blue" ,"blue", "blue" ,"black","red"  ],[127X[104X
    [4X[25X>[125X [27X       ["red"  ,"blue", "blue" ,"blue" ,"black"]];;[127X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraphByMatrix(m);[127X[104X
    [4X[28X<color graph of order 5 and rank 3>[128X[104X
    [4X[25Xgap>[125X [27XDisplay(AdjacencyMatrix(cgr));[127X[104X
    [4X[28X[ [  1,  3,  2,  2,  2 ],[128X[104X
    [4X[28X  [  2,  1,  3,  2,  2 ],[128X[104X
    [4X[28X  [  2,  2,  1,  3,  2 ],[128X[104X
    [4X[28X  [  2,  2,  2,  1,  3 ],[128X[104X
    [4X[28X  [  3,  2,  2,  2,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr)[127X[104X
    [4X[28X[ "black", "blue", "red" ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [33X[0;0YIn  the second form [10XAdjacencyMatrix(cgr,colors)[110X returns a 0/1-matrix [22XA(i,j)[122X,
  that  has entry 1 at [22X(i,j)[122X iff the entry of [10XAdjacencyMatrix(cgr)[110X at [22X(i,j)[122X is
  an element of the list [3Xcolors[103X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XDisplay(AdjacencyMatrix(cgr, [1,3]));[127X[104X
    [4X[28X[ [  1,  1,  0,  0,  0 ],[128X[104X
    [4X[28X  [  0,  1,  1,  0,  0 ],[128X[104X
    [4X[28X  [  0,  0,  1,  1,  0 ],[128X[104X
    [4X[28X  [  0,  0,  0,  1,  1 ],[128X[104X
    [4X[28X  [  1,  0,  0,  0,  1 ] ][128X[104X
    [4X[28X        [128X[104X
  [4X[32X[104X
  
  [1X1.4-9 RowOfColorGraph[101X
  
  [33X[1;0Y[29X[2XRowOfColorGraph[102X( [3Xcgr[103X, [3Xi[103X ) [32X operation[133X
  
  [33X[0;0YReturns  the  [22Xi[122X-th  row  of  the  adjacency  matrix  of [3Xcgr[103X ([2XAdjacencyMatrix[102X
  ([14X1.4-8[114X)).[133X
  
  [1X1.4-10 ColumnOfColorGraph[101X
  
  [33X[1;0Y[29X[2XColumnOfColorGraph[102X( [3Xcgr[103X, [3Xj[103X ) [32X operation[133X
  
  [33X[0;0YReturns  the  [22Xj[122X-th  column  of  the adjacency matrix of [3Xcgr[103X ([2XAdjacencyMatrix[102X
  ([14X1.4-8[114X)).[133X
  
  [1X1.4-11 Fibres[101X
  
  [33X[1;0Y[29X[2XFibres[102X( [3Xcgr[103X ) [32X operation[133X
  
  [33X[0;0YThe  [13XFibres[113X  of  a  color  graph  are  the  maximal  sets  of vertices whose
  corresponding loops all have the same color.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(SymmetricGroup(4), Combinations([1..4]), OnSets,[127X[104X
    [4X[25X>[125X [27Xtrue, functions(m1,m2) return Length(Intersection(m1,m2));end);[127X[104X
    [4X[28X<color graph of order 16 and rank 5>[128X[104X
    [4X[25Xgap>[125X [27XFibres(cgr);[127X[104X
    [4X[28X[ [ 1 ], [ 2, 10, 14, 16 ], [ 3, 7, 9, 11, 13, 15 ], [ 4, 6, 8, 12 ], [ 5 ] ][128X[104X
    [4X[25Xgap>[125X [27XVertexNamesOfCocoObject(cgr);[127X[104X
    [4X[28X[ [  ], [ 1 ], [ 1, 2 ], [ 1, 2, 3 ], [ 1, 2, 3, 4 ], [ 1, 2, 4 ],[128X[104X
    [4X[28X[ 1, 3 ], [ 1, 3, 4 ], [ 1, 4 ], [ 2 ], [ 2, 3 ], [ 2, 3, 4 ],[128X[104X
    [4X[28X[ 2, 4 ], [ 3 ], [ 3, 4 ], [ 4 ] ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-12 NumberOfFibres[101X
  
  [33X[1;0Y[29X[2XNumberOfFibres[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YReturns  the  number  of  different  colors  of  loops  of  [3Xcgr[103X  (cf. [2XFibres[102X
  ([14X1.4-11[114X)).[133X
  
  [1X1.4-13 LocalIntersectionArray[101X
  
  [33X[1;0Y[29X[2XLocalIntersectionArray[102X( [3Xcgr[103X, [3Xv[103X, [3Xw[103X ) [32X method[133X
  [33X[1;0Y[29X[2XLocalIntersectionArray[102X( [3Xcgr[103X, [3Xarc[103X ) [32X method[133X
  
  [33X[0;0YThe  input  to  this operation is a color graph [3Xcgr[103X and an arc. In the first
  version this arc is given as two parameters [3Xv[103X, and [3Xw[103X. In the second form the
  arc  is  given  as  ordered  pair  [3Xarc[103X. We will assume in the following that
  [10Xarc=[v,w][110X.  The  local  intersection  array  of  the arc [22X(v,w)[122X is the square
  matrix  [22XA[122X of order [10XRankOfColorGraph(cgr)[110X where [22XA(i,j)[122X is equal to the number
  of  vertices  [22Xu[122X of [3Xcgr[103X such that the arc [22X(v,u)[122X has color [22Xi[122X and the arc [22X(u,w)[122X
  has color [22Xj[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=JohnsonScheme(5,2);[127X[104X
    [4X[28X<color graph of order 10 and rank 3>[128X[104X
    [4X[25Xgap>[125X [27XColorRepresentative(cgr,1);[127X[104X
    [4X[28X[ 1, 1 ][128X[104X
    [4X[25Xgap>[125X [27XColorRepresentative(cgr,2);[127X[104X
    [4X[28X[ 1, 2 ][128X[104X
    [4X[25Xgap>[125X [27XColorRepresentative(cgr,3);[127X[104X
    [4X[28X[ 1, 8 ][128X[104X
    [4X[25Xgap>[125X [27XDisplay(LocalIntersectionArray(cgr,1,1));[127X[104X
    [4X[28X[ [  1,  0,  0 ],[128X[104X
    [4X[28X  [  0,  6,  0 ],[128X[104X
    [4X[28X  [  0,  0,  3 ] ][128X[104X
    [4X[25Xgap>[125X [27XDisplay(LocalIntersectionArray(cgr,1,2));[127X[104X
    [4X[28X[ [  0,  1,  0 ],[128X[104X
    [4X[28X  [  1,  3,  2 ],[128X[104X
    [4X[28X  [  0,  2,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27XDisplay(LocalIntersectionArray(cgr,1,8));[127X[104X
    [4X[28X[ [  0,  0,  1 ],[128X[104X
    [4X[28X  [  0,  4,  2 ],[128X[104X
    [4X[28X  [  1,  2,  0 ] ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-14 ColorMates[101X
  
  [33X[1;0Y[29X[2XColorMates[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YIn  a  WL-stable  color graph for every color [22Xi[122X there exists a color [22Xi'[122X such
  that  whenever  an  arc  [22X(u,v)[122X  has color [22Xi[122X, then the opposite arc [22X(v,u)[122X has
  color  [22Xi'[122X.  The  mapping  from  [22Xi[122X  to [22Xi'[122X is a permutation of the colors. The
  function [10XColorMates[110X returns this permutation.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(Group((1,2,3,4,5)));;[127X[104X
    [4X[25Xgap>[125X [27XDisplay(AdjacencyMatrix(cgr));[127X[104X
    [4X[28X[ [  1,  2,  3,  4,  5 ],[128X[104X
    [4X[28X  [  5,  1,  2,  3,  4 ],[128X[104X
    [4X[28X  [  4,  5,  1,  2,  3 ],[128X[104X
    [4X[28X  [  3,  4,  5,  1,  2 ],[128X[104X
    [4X[28X  [  2,  3,  4,  5,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27XColorMates(cgr);[127X[104X
    [4X[28X(2,5)(3,4)[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.4-15 OutValencies[101X
  
  [33X[1;0Y[29X[2XOutValencies[102X( [3Xcgr[103X ) [32X method[133X
  
  [33X[0;0YLet  [22Xi[122X  and  a color of [3Xcgr[103X. Then there is a number [22Xd(i)[122X such that for every
  vertex  [22Xv[122X  of  [3Xcgr[103X  there  is  either no arc, or there are exactly [22Xd(i)[122X arcs
  leaving [22Xv[122X. The number [22Xd(i)[122X is called the [13Xsubdegree[113X of the color [22Xi[122X.[133X
  
  [33X[0;0YThe       function       [10XOutValencies[110X      returns      a      the      list
  [10X[d(1),d(2),...,d(RankOfColorGraph(cgr))][110X[133X
  
  [1X1.4-16 ReflexiveColors[101X
  
  [33X[1;0Y[29X[2XReflexiveColors[102X( [3Xcgr[103X ) [32X method[133X
  
  [33X[0;0YThis  function  returns  the  list  of all reflexive colors of the WL-stable
  color graph [3Xcgr[103X.[133X
  
  
  [1X1.5 [33X[0;0YCreating new (color) graphs from given color graphs[133X[101X
  
  [1X1.5-1 ColorGraphByFusion[101X
  
  [33X[1;0Y[29X[2XColorGraphByFusion[102X( [3Xcgr[103X, [3Xfusion[103X ) [32X operation[133X
  
  [33X[0;0YThe  function  takes as arguments a color graph [3Xcgr[103X and a fusion. The fusion
  can  be  either  a  list  of  sets  of colors, or it belongs to the category
  [10XIsFusionOfTensor[110X      and      more     concretely     to     the     family
  [10XFusionFamily(StructureConstantsOfColorGraph(cgr))[110X.  In  the latter case, [3Xcgr[103X
  has to be WL-stable.[133X
  
  [33X[0;0YThe  fusion-color  graph  has  the  same order like [3Xcgr[103X. The color of an arc
  [22X(i,j)[122X  in  the  fusion  color  graph is the list of all classes of [3Xfusion[103X to
  which  [10XArcColorOfColorGraph(cgr,i,j)[110X belongs. If [3Xfusion[103X is a partition, then
  the  effect  is  that  all  colors  in one class are fused into the same new
  color.  If [3Xfusion[103X is not a partition, then the resulting color graph will be
  color-isomorphic  to  the  fusion  color  graph  of  [3Xcgr[103X with respect to the
  coarsest  partition that allows to obtain every element of [3Xfusion[103X as a union
  of classes.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(Group((1,2,3,4,5)));[127X[104X
    [4X[28X<color graph of order 5 and rank 5>[128X[104X
    [4X[25Xgap>[125X [27Xcgr2:=ColorGraphByFusion(cgr,[[1],[2,3],[4],[5]]);[127X[104X
    [4X[28X<color graph of order 5 and rank 4>[128X[104X
    [4X[25Xgap>[125X [27XDisplay(AdjacencyMatrix(cgr));[127X[104X
    [4X[28X[ [  1,  2,  3,  4,  5 ],[128X[104X
    [4X[28X  [  5,  1,  2,  3,  4 ],[128X[104X
    [4X[28X  [  4,  5,  1,  2,  3 ],[128X[104X
    [4X[28X  [  3,  4,  5,  1,  2 ],[128X[104X
    [4X[28X  [  2,  3,  4,  5,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27XDisplay(AdjacencyMatrix(cgr2));[127X[104X
    [4X[28X[ [  1,  2,  2,  3,  4 ],[128X[104X
    [4X[28X  [  4,  1,  2,  2,  3 ],[128X[104X
    [4X[28X  [  3,  4,  1,  2,  2 ],[128X[104X
    [4X[28X  [  2,  3,  4,  1,  2 ],[128X[104X
    [4X[28X  [  2,  2,  3,  4,  1 ] ][128X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr2);[127X[104X
    [4X[28X[ [ [ 1 ] ], [ [ 2, 3 ] ], [ [ 4 ] ], [ [ 5 ] ] ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.5-2 QuotientColorGraph[101X
  
  [33X[1;0Y[29X[2XQuotientColorGraph[102X( [3Xcgr[103X, [3Xpart[103X ) [32X operation[133X
  
  [33X[0;0Y[3Xpart[103X is a partition of the vertex set of the color graph [3Xcgr[103X (it has to be a
  set of sets of vertices). The quotient graph of [3Xcgr[103X with respect to [3Xpart[103X has
  as  vertex  set  the  classes  of  [3Xpart[103X. the color of the arc [22X([u], [v])[122X the
  quotient  graph  is  the  set  of  all  colors  [22Xi[122X of [3Xcgr[103X such that there are
  vertices [22Xu'âˆˆ [u][122X and [22Xv'âˆˆ [v][122X such that the arc [22X(u', v')[122X has color [22Xi[122X.[133X
  
  [33X[0;0YThe  above  described  color  graph  is  also well-defined, if [3Xpart[103X is not a
  partition   but   any   set   of   sets   of   vertices  of  [3Xcgr[103X.  In  fact,
  [10XQuotientColorGraph[110X does not check, whether [3Xpart[103X is indeed a partition.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xs5:=SymmetricGroup(5);;[127X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(s5, Arrangements([1..5],2), OnPairs,true);[127X[104X
    [4X[28X<color graph of order 20 and rank 7>[128X[104X
    [4X[25Xgap>[125X [27Xpart:=Set(Orbit(s5, [[1,2],[2,1]], OnSetsTuples));;[127X[104X
    [4X[25Xgap>[125X [27Xpart:=Set(part, x->Set(x, y->Position(VertexNamesOfCocoObject(cgr),y)));[127X[104X
    [4X[28X[ [ 1, 5 ], [ 2, 9 ], [ 3, 13 ], [ 4, 17 ], [ 6, 10 ], [ 7, 14 ],[128X[104X
    [4X[28X[ 8, 18 ], [ 11, 15 ], [ 12, 19 ], [ 16, 20 ] ][128X[104X
    [4X[25Xgap>[125X [27Xcgr2:=QuotientColorGraph(cgr,part);[127X[104X
    [4X[28X<color graph of order 10 and rank 3>[128X[104X
    [4X[25Xgap>[125X [27XColorNames(cgr2);[127X[104X
    [4X[28X[ [ 1, 3 ], [ 2, 4, 5, 6 ], [ 7 ] ][128X[104X
    [4X[25Xgap>[125X [27XVertexNamesOfCocoObject(cgr2);[127X[104X
    [4X[28X[ [ 1, 5 ], [ 2, 9 ], [ 3, 13 ], [ 4, 17 ], [ 6, 10 ], [ 7, 14 ],[128X[104X
    [4X[28X[ 8, 18 ], [ 11, 15 ], [ 12, 19 ], [ 16, 20 ] ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.5-3 InducedSubColorGraph[101X
  
  [33X[1;0Y[29X[2XInducedSubColorGraph[102X( [3Xcgr[103X, [3Xset[103X ) [32X operation[133X
  
  [33X[0;0YThis  function  returns  a  color  graph that is isomorphic to the sub color
  graph  induced by [3Xset[103X. The function that maps [22Xi[122X to [10Xset[i][110X is an embedding of
  the induced subgraph into [3Xcgr[103X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(SymmetricGroup(5), Combinations([1..5]), OnSets, true);[127X[104X
    [4X[28X<color graph of order 32 and rank 56>[128X[104X
    [4X[25Xgap>[125X [27Xvn:=VertexNamesOfCocoObject(cgr);;[127X[104X
    [4X[25Xgap>[125X [27Xfibre:=Filtered([1..Length(vn)], i->Length(vn[i])=2);[127X[104X
    [4X[28X[ 3, 11, 15, 17, 19, 23, 25, 27, 29, 31 ][128X[104X
    [4X[25Xgap>[125X [27Xcgr2:=InducedSubColorGraph(cgr,fibre);[127X[104X
    [4X[28X<color graph of order 10 and rank 3>[128X[104X
    [4X[25Xgap>[125X [27XVertexNamesOfCocoObject(cgr2);[127X[104X
    [4X[28X[ 3, 11, 15, 17, 19, 23, 25, 27, 29, 31 ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.5-4 DirectProductColorGraphs[101X
  
  [33X[1;0Y[29X[2XDirectProductColorGraphs[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  
  [33X[0;0YSuppose,  [3Xcgr1[103X is the color graph [22X(V_1,C_1,f_1)[122X, and [3Xcgr2[103X is the color graph
  [22X(V_2,C_2,f_2)[122X.  Then the direct product of [3Xcgr1[103X with [3Xcgr2[103X has vertex set [22XV_1
  Ã— V_2[122X, and color set [22XC_1 Ã— C_2[122X. The coloring function is [22Xf_1 Ã— f_2[122X. Here [22Xf_1
  Ã— f_2[122X acts coordinate wise.[133X
  
  [33X[0;0YThe  operation  [10XDirectProductColorGraphs[110X  returns the direct product of [3Xcgr1[103X
  with [3Xcgr2[103X.[133X
  
  [1X1.5-5 WreathProductColorGraphs[101X
  
  [33X[1;0Y[29X[2XWreathProductColorGraphs[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  
  [33X[0;0YSuppose,  [3Xcgr1[103X is the color graph [22X(V_1,C_1,f_1)[122X, and [3Xcgr2[103X is the color graph
  [22X(V_2,C_2,f_2)[122X.  Suppose,  [22XD_1[122X  is  the set of all those colors of [3Xcgr1[103X whose
  color  class contains reflexive tuples. Then the wreath product of [3Xcgr1[103X with
  [3Xcgr2[103X  has  vertex set [22XV_1 Ã— V_2[122X. The set of colors is the union of [22XC_1 Ã— {*}[122X
  with  [22XD_1  Ã— C_2[122X. The coloring function maps pairs [22X((a_1,a_2), (a_1,b_2))[122X to
  [22X(f_1(a_1,a_1),f_2(b_1,b_2))[122X,   and   other  pairs  [22X((a_1,a_2),(b_1,b_2))[122X  to
  [22X(f_1(a_1,a_2),*)[122X.[133X
  
  [33X[0;0YThe  operation  [10XWreathProductColorGraphs[110X  returns the wreath product of [3Xcgr1[103X
  with [3Xcgr2[103X.[133X
  
  [1X1.5-6 ClosedSets[101X
  
  [33X[1;0Y[29X[2XClosedSets[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YA  set  [10Xcset[110X of colors of [3Xcgr[103X is closed if the collections of all arcs whose
  color  is  from  [10Xcset[110X forms an equivalence relation. This function returns a
  list of all closed sets of colors of [3Xcgr[103X.[133X
  
  [1X1.5-7 PartitionClosedSet[101X
  
  [33X[1;0Y[29X[2XPartitionClosedSet[102X( [3Xcgr[103X, [3Xcset[103X ) [32X operation[133X
  
  [33X[0;0YA  set  [3Xcset[103X of colors of [3Xcgr[103X is closed if the collections of all arcs whose
  color  is from [3Xcset[103X forms an equivalence relation. This function returns the
  vertex-partition  corresponding  to  this  equivalence  relation.  It is not
  tested,  whether  [3Xcset[103X  is  indeed  closed.  It  is  required  that [3Xcgr[103X is a
  homogeneous WL-stable color graph.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xs5:=SymmetricGroup(5);;[127X[104X
    [4X[25Xgap>[125X [27Xd6:=Subgroup(s5, [(1,2),(1,2,3)(4,5)]);;[127X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(s5,s5,OnRight,true, function(a,b) return a*b;end);[127X[104X
    [4X[28X<color graph of order 120 and rank 120>[128X[104X
    [4X[25Xgap>[125X [27Xcset:=Set(d6, x->Position(ColorNames(cgr),x));[127X[104X
    [4X[28X[ 1, 8, 13, 24, 29, 31, 61, 68, 73, 84, 89, 91 ][128X[104X
    [4X[25Xgap>[125X [27XIsWLStableColorGraph(cgr);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsHomogeneous(cgr);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xpart:=PartitionClosedSet(cgr,cset);;[127X[104X
    [4X[25Xgap>[125X [27Xcgr2:=QuotientColorGraph(cgr,part);[127X[104X
    [4X[28X<color graph of order 10 and rank 3>[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.5-8 BaseGraphOfColorGraph[101X
  
  [33X[1;0Y[29X[2XBaseGraphOfColorGraph[102X( [3Xcgr[103X, [3Xcolor[103X ) [32X method[133X
  [33X[1;0Y[29X[2XBaseGraphOfColorGraph[102X( [3Xcgr[103X, [3Xcset[103X ) [32X method[133X
  
  [33X[0;0YThis  function extracts graphs from a color graph. In the first variant, the
  second  argument  is  one  color.  In  this case the digraph with vertex set
  [10X[1..OrderOfColorGraph(cgr)][110X and with all arcs of color [3Xcolor[103X from [3Xcgr[103X.[133X
  
  [33X[0;0YIn the second case the arc-set of the result consists of all arcs with color
  from [3Xcset[103X of [3Xcgr[103X.[133X
  
  [33X[0;0YThis function is available only if [5XGrape[105X is loaded.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=JohnsonScheme(5,2);[127X[104X
    [4X[28X<color graph of order 10 and rank 3>[128X[104X
    [4X[25Xgap>[125X [27XOutValencies(cgr);[127X[104X
    [4X[28X[ 1, 6, 3 ][128X[104X
    [4X[25Xgap>[125X [27Xgamma:=BaseGraphOfColorGraph(cgr,3);;[127X[104X
    [4X[25Xgap>[125X [27XIsDistanceRegular(gamma);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XGlobalParameters(gamma);[127X[104X
    [4X[28X[ [ 0, 0, 3 ], [ 1, 0, 2 ], [ 1, 2, 0 ] ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  
  [1X1.6 [33X[0;0YTesting properties of color graphs[133X[101X
  
  [1X1.6-1 IsUndirectedColorGraph[101X
  
  [33X[1;0Y[29X[2XIsUndirectedColorGraph[102X( [3Xcgr[103X ) [32X property[133X
  
  [33X[0;0YA color graph is called [13Xundirected[113X if for all vertices [22Xu[122X and [22Xv[122X the arc [22X(u,v)[122X
  has  the  same  color as the arc [22X(v,u)[122X. The function tests this property for
  [3Xcgr[103X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(Group((1,2,3,4,5)));[127X[104X
    [4X[28X<color graph of order 5 and rank 5>[128X[104X
    [4X[25Xgap>[125X [27XIsUndirectedColorGraph(cgr);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XArcColorOfColorGraph(cgr,[1,2]);[127X[104X
    [4X[28X2[128X[104X
    [4X[25Xgap>[125X [27XArcColorOfColorGraph(cgr,[2,1]);[127X[104X
    [4X[28X5[128X[104X
    [4X[25Xgap>[125X [27Xcgr2:=ColorGraphByFusion(cgr, [[1],[2,5],[3,4]]);[127X[104X
    [4X[28X<color graph of order 5 and rank 3>[128X[104X
    [4X[25Xgap>[125X [27XIsUndirectedColorGraph(cgr2);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.6-2 IsHomogeneous[101X
  
  [33X[1;0Y[29X[2XIsHomogeneous[102X( [3Xcgr[103X ) [32X property[133X
  
  [33X[0;0YA color graph is homogeneous if it has just one fibre. For a WL-stable color
  graph this means that it has just one reflexive color. For a WL-stable color
  graph this means that it correspond to an association scheme.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xe8:=ElementaryAbelianGroup(8);[127X[104X
    [4X[28X<pc group of size 8 with 3 generators>[128X[104X
    [4X[25Xgap>[125X [27Xe8:=Action(e8,AsList(e8), OnRight);[127X[104X
    [4X[28XGroup([ (1,2)(3,5)(4,6)(7,8), (1,3)(2,5)(4,7)(6,8), (1,4)(2,6)(3,7)(5,8) ])[128X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(e8,Combinations([1..DegreeAction(g)],2), OnSets);[127X[104X
    [4X[28X<color graph of order 28 and rank 112>[128X[104X
    [4X[25Xgap>[125X [27XIsHomogeneous(cgr);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.6-3 IsWLStableColorGraph[101X
  
  [33X[1;0Y[29X[2XIsWLStableColorGraph[102X( [3Xcgr[103X ) [32X property[133X
  
  [33X[0;0YThis  function  returns  true  if  [3Xcgr[103X  is stable under the Weisfeiler-Leman
  algorithm,   that   is,  whether  it  is  the  color  graph  of  a  coherent
  configuration.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(Center(GL(2,7)), GF(7)^2, OnRight, true,[127X[104X
    [4X[25X>[125X [27Xfunction(a,b) return NormedRowVector(a-b);end);[127X[104X
    [4X[28X<color graph of order 49 and rank 9>[128X[104X
    [4X[25Xgap>[125X [27XIsWLStableColorGraph(cgr);[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.6-4 IsSchurian[101X
  
  [33X[1;0Y[29X[2XIsSchurian[102X( [3Xcgr[103X ) [32X property[133X
  
  [33X[0;0YA  color  graph  is  called  [13XSchurian[113X if it is color isomorphic to the color
  graph of orbitals of its automorphism group.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xlcgr:=AllAssociationSchemes(15);;[127X[104X
    [4X[25Xgap>[125X [27Xlcgr:=Filtered(lcgr, x->not IsSchurian(x));[127X[104X
    [4X[28X[ AS(15,5) ][128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  [1X1.6-5 IsPrimitive[101X
  
  [33X[1;0Y[29X[2XIsPrimitive[102X( [3Xcgr[103X ) [32X property[133X
  
  [33X[0;0YA  WL-stable  color  graph  is primitive if all its loopless base graphs are
  strongly connected (cf. [2XBaseGraphOfColorGraph[102X ([14X1.5-8[114X)). This function tests,
  whether [3Xcgr[103X is primitive or not.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xcgr:=ColorGraph(Group((1,2,3,4)));[127X[104X
    [4X[28X<color graph of order 4 and rank 4>[128X[104X
    [4X[25Xgap>[125X [27XIsPrimitive(cgr);[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XReflexiveColors(cgr);[127X[104X
    [4X[28X[ 1 ][128X[104X
    [4X[25Xgap>[125X [27XIsConnectedGraph(BaseGraphOfColorGraph(cgr,2));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XIsConnectedGraph(BaseGraphOfColorGraph(cgr,3));[127X[104X
    [4X[28Xfalse[128X[104X
    [4X[25Xgap>[125X [27XIsConnectedGraph(BaseGraphOfColorGraph(cgr,4));[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X	    [128X[104X
  [4X[32X[104X
  
  
  [1X1.7 [33X[0;0YSymmetries of color graphs[133X[101X
  
  [1X1.7-1 KnownGroupOfAutomorphisms[101X
  
  [33X[1;0Y[29X[2XKnownGroupOfAutomorphisms[102X( [3Xcgr[103X ) [32X operation[133X
  
  [33X[0;0YThis  function  returns  the  group  of all automorphisms of [3Xcgr[103X that [5XCOCO2P[105X
  knows at the given moment.[133X
  
  [1X1.7-2 AutGroupOfCocoObject[101X
  
  [33X[1;0Y[29X[2XAutGroupOfCocoObject[102X( [3Xcgr[103X ) [32X attribute[133X
  [33X[1;0Y[29X[2XAutomorphismGroup[102X( [3Xcgr[103X ) [32X method[133X
  
  [33X[0;0YReturns  the  group of all permutations of the vertices of [3Xcgr[103X that preserve
  the color of all arcs.[133X
  
  [1X1.7-3 IsAutomorphismOfObject[101X
  
  [33X[1;0Y[29X[2XIsAutomorphismOfObject[102X( [3Xcgr[103X, [3Xperm[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XIsAutomorphismOfColorGraph[102X( [3Xcgr[103X, [3Xperm[103X ) [32X operation[133X
  
  [33X[0;0YReturns  [10Xtrue[110X,  if  [3Xperm[103X is an automorphism of [3Xcgr[103X. In that case [5XCOCO2P[105X adds
  [3Xperm[103X to the known automorphisms of [3Xcgr[103X.[133X
  
  [1X1.7-4 IsomorphismCocoObjects[101X
  
  [33X[1;0Y[29X[2XIsomorphismCocoObjects[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XIsomorphismColorGraphs[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  
  [33X[0;0YAn isomorphism from [3Xcgr1[103X to [3Xcgr2[103X is a bijection between the vertex sets that
  preserves the color of arcs (including the names of colors).[133X
  
  [33X[0;0YThis  operation  returns  an isomorphism from [3Xcgr1[103X to [3Xcgr2[103X if it exists, and
  [10Xfail[110X if it does not exists.[133X
  
  [1X1.7-5 IsIsomorphicCocoObject[101X
  
  [33X[1;0Y[29X[2XIsIsomorphicCocoObject[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XIsIsomorphicColorGraph[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  
  [33X[0;0YReturns  [10Xtrue[110X  if  [3Xcgr1[103X  and  [3Xcgr2[103X  are isomorphic, and [10Xfalse[110X otherwise (cf.
  [2XIsomorphismCocoObjects[102X ([14X1.7-4[114X))[133X
  
  [1X1.7-6 IsIsomorphismOfObjects[101X
  
  [33X[1;0Y[29X[2XIsIsomorphismOfObjects[102X( [3Xcgr1[103X, [3Xcgr2[103X, [3Xg[103X ) [32X operation[133X
  [33X[1;0Y[29X[2XIsIsomorphismOfColorGraphs[102X( [3Xcgr1[103X, [3Xcgr2[103X, [3Xg[103X ) [32X operation[133X
  
  [33X[0;0YReturns  [10Xtrue[110X  if  [3Xg[103X is an isomorphism fro [3Xcgr1[103X to [3Xcgr2[103X, and [10Xfalse[110X otherwise
  (cf. [2XIsomorphismCocoObjects[102X ([14X1.7-4[114X)).[133X
  
  [1X1.7-7 KnownGroupOfColorAutomorphisms[101X
  
  [33X[1;0Y[29X[2XKnownGroupOfColorAutomorphisms[102X( [3Xcgr[103X ) [32X operation[133X
  
  [33X[0;0YThis  function  returns  the  group  of  all color automorphisms of [3Xcgr[103X that
  [5XCOCO2P[105X knows at the given moment.[133X
  
  [1X1.7-8 LiftToColorAutomorphism[101X
  
  [33X[1;0Y[29X[2XLiftToColorAutomorphism[102X( [3Xcgr[103X, [3Xperm[103X ) [32X operation[133X
  
  [33X[0;0Y[3Xcgr[103X  is  a color graph and [3Xperm[103X is a permutation of its colors. The function
  constructs a color automorphism of [3Xcgr[103X that acts like [3Xperm[103X on the colors. If
  such a color automorphism does not exist, then [10Xfail[110X is returned.[133X
  
  [33X[0;0YIf  [3Xperm[103X  is  liftable, then the result of the lifting is added to the known
  group of color automorphisms of [3Xcgr[103X.[133X
  
  [1X1.7-9 LiftToColorIsomorphism[101X
  
  [33X[1;0Y[29X[2XLiftToColorIsomorphism[102X( [3Xcgr1[103X, [3Xcgr2[103X, [3Xciso[103X ) [32X operation[133X
  
  [33X[0;0Y[3Xcgr1[103X  and  [3Xcgr2[103X  are  color graphs of the same rank, and [3Xciso[103X is a bijection
  from  the  colors  of  [3Xcgr1[103X to the colors of [3Xcgr2[103X. The function constructs a
  color  isomorphism  from  [3Xcgr1[103X to [3Xcgr2[103X that acts like [3Xciso[103X on the colors. If
  such a color isomorphism does not exist, then [10Xfail[110X is returned.[133X
  
  [1X1.7-10 ColorIsomorphismColorGraphs[101X
  
  [33X[1;0Y[29X[2XColorIsomorphismColorGraphs[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  
  [33X[0;0YThis  operation  returns  a  color  isomorphism  from [3Xcgr1[103X to [3Xcgr2[103X, and [10Xfail[110X
  otherwise.[133X
  
  [33X[0;0YAt  the  moment,  this  operation  is  implemented only from WL-stable color
  graphs.[133X
  
  [1X1.7-11 IsColorIsomorphicColorGraph[101X
  
  [33X[1;0Y[29X[2XIsColorIsomorphicColorGraph[102X( [3Xcgr1[103X, [3Xcgr2[103X ) [32X operation[133X
  
  [33X[0;0YThis operation returns [10Xtrue[110X if [3Xcgr1[103X and [3Xcgr2[103X are color isomorphic, and [10Xfalse[110X
  otherwise.[133X
  
  [33X[0;0YAt  the  moment,  this  operation  is  implemented only from WL-stable color
  graphs.[133X
  
  [1X1.7-12 ColorAutomorphismGroup[101X
  
  [33X[1;0Y[29X[2XColorAutomorphismGroup[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YThis function computes and returns the color automorphism group of [3Xcgr[103X. This
  group  consists of all permutations of the vertices of the color graph, that
  map  arcs of the same color to arcs of the same color. In particular, it may
  act non-trivially on the colors of [3Xcgr[103X.[133X
  
  [33X[0;0YIf  [3Xcgr[103X  is  a  Schurian  WL-stable color graph, then its color automorphism
  group  is  equal  to  the  normalizer  of its automorphism group in the full
  symmetric  group  of  the vertices of [3Xcgr[103X. In some (rare) cases, this way to
  compute normalizers can be quicker than the built-in gap-functions.[133X
  
  [33X[0;0YAt the moment, this function is implemented only for WL-stable color graphs.[133X
  
  [1X1.7-13 ColorAutomorphismGroupOnColors[101X
  
  [33X[1;0Y[29X[2XColorAutomorphismGroupOnColors[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YThe  color  automorphism  of  [3Xcgr[103X  acts  on  the  colors  of  [3Xcgr[103X  with  the
  automorphism group of [3Xcgr[103X as kernel. This function computes and returns this
  action.[133X
  
  [33X[0;0YAt the moment, this function is implemented only for WL-stable color graphs.[133X
  
  [1X1.7-14 KnownGroupOfAlgebraicAutomorphisms[101X
  
  [33X[1;0Y[29X[2XKnownGroupOfAlgebraicAutomorphisms[102X( [3Xcgr[103X ) [32X operation[133X
  
  [33X[0;0YThis  function  returns the group of all algebraic automorphisms of [3Xcgr[103X that
  [5XCOCO2P[105X knows at the given moment.[133X
  
  [1X1.7-15 AlgebraicAutomorphismGroup[101X
  
  [33X[1;0Y[29X[2XAlgebraicAutomorphismGroup[102X( [3Xcgr[103X ) [32X attribute[133X
  
  [33X[0;0YThe  algebraic  automorphism group of a WL-stable color graph is nothing but
  the  automorphism  group  of  its  tensor  of structure constants. The color
  automorphism  group  in  its  action  on  colors  embeds  naturally into the
  algebraic automorphism group.[133X
  
